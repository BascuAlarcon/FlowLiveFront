<!-- Header del Livestream -->
<div class="card" *ngIf="livestreamData">
  <div class="card-body">
    <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 1.5em;">
      <div style="flex: 1;">
        <h2 class="card-title" style="margin-bottom: 0.5em;">{{ livestreamData.livestream.title }}</h2>
        <div style="display: flex; gap: 1em; flex-wrap: wrap; align-items: center;">
          <span style="font-size: 1.5rem;">{{ getPlatformIcon(livestreamData.livestream.platform) }}</span>
          <span style="color: #6C757D;">{{ livestreamData.livestream.platform | titlecase }}</span>
          <span *ngIf="livestreamData.livestream.isActive" 
                style="background-color: #28a745; color: white; padding: 0.25em 0.75em; border-radius: 12px; font-size: 0.875rem; font-weight: 600;">
            ðŸ”´ En Vivo
          </span>
          <span *ngIf="!livestreamData.livestream.isActive" 
                style="background-color: #6c757d; color: white; padding: 0.25em 0.75em; border-radius: 12px; font-size: 0.875rem; font-weight: 600;">
            Finalizado
          </span>
        </div>
      </div>
    </div>
    
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1em; padding: 1em; background-color: #f8f9fa; border-radius: 8px;">
      <div>
        <label style="color: #6C757D; font-size: 0.875rem; display: block; margin-bottom: 0.25em;">DuraciÃ³n</label>
        <span style="color: #1D2345; font-weight: 600;">{{ formatDuration(livestreamData.stats.durationMinutes) }}</span>
      </div>
      <div>
        <label style="color: #6C757D; font-size: 0.875rem; display: block; margin-bottom: 0.25em;">Fecha de Inicio</label>
        <span style="color: #1D2345; font-weight: 600;">{{ formatDate(livestreamData.livestream.startedAt) }}</span>
      </div>
      <div>
        <label style="color: #6C757D; font-size: 0.875rem; display: block; margin-bottom: 0.25em;">Espectadores</label>
        <span style="color: #1D2345; font-weight: 600;">{{ formatNumber(livestreamData.livestream.viewerCount) }}</span>
      </div>
      <div *ngIf="livestreamData.livestream.endedAt">
        <label style="color: #6C757D; font-size: 0.875rem; display: block; margin-bottom: 0.25em;">Fecha de Fin</label>
        <span style="color: #1D2345; font-weight: 600;">{{ formatDate(livestreamData.livestream.endedAt) }}</span>
      </div>
    </div>
  </div>
</div>

<!-- Grid de MÃ©tricas Principales -->
<div class="card" *ngIf="livestreamData">
  <div class="card-body">
    <h2 class="card-title">MÃ©tricas Principales</h2>
    
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1.5em; margin-top: 1em;">
      <!-- Monto Total Vendido -->
      <div style="padding: 1.5em; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 12px; color: white;">
        <div style="font-size: 0.875rem; opacity: 0.9; margin-bottom: 0.5em;">Monto Total Vendido</div>
        <div style="font-size: 1.75rem; font-weight: 700;">{{ formatCurrency(livestreamData.stats.totalRevenue) }}</div>
      </div>
      
      <!-- Ventas Totales -->
      <div style="padding: 1.5em; background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); border-radius: 12px; color: white;">
        <div style="font-size: 0.875rem; opacity: 0.9; margin-bottom: 0.5em;">Ventas Totales</div>
        <div style="font-size: 1.75rem; font-weight: 700;">{{ formatNumber(livestreamData.stats.totalSales) }}</div>
      </div>
      
      <!-- Clientes Ãšnicos -->
      <div style="padding: 1.5em; background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); border-radius: 12px; color: white;">
        <div style="font-size: 0.875rem; opacity: 0.9; margin-bottom: 0.5em;">Clientes Ãšnicos</div>
        <div style="font-size: 1.75rem; font-weight: 700;">{{ formatNumber(livestreamData.stats.totalCustomers) }}</div>
      </div>
      
      <!-- Productos Vendidos -->
      <div style="padding: 1.5em; background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); border-radius: 12px; color: white;">
        <div style="font-size: 0.875rem; opacity: 0.9; margin-bottom: 0.5em;">Productos Vendidos</div>
        <div style="font-size: 1.75rem; font-weight: 700;">{{ formatNumber(livestreamData.stats.totalProductsSold) }}</div>
      </div>
      
      <!-- Ticket Promedio -->
      <div style="padding: 1.5em; background: linear-gradient(135deg, #fa709a 0%, #fee140 100%); border-radius: 12px; color: white;">
        <div style="font-size: 0.875rem; opacity: 0.9; margin-bottom: 0.5em;">Ticket Promedio</div>
        <div style="font-size: 1.75rem; font-weight: 700;">{{ formatCurrency(livestreamData.stats.averageTicket) }}</div>
      </div>
      
      <!-- Tasa de ConversiÃ³n -->
      <div style="padding: 1.5em; background: linear-gradient(135deg, #30cfd0 0%, #330867 100%); border-radius: 12px; color: white;">
        <div style="font-size: 0.875rem; opacity: 0.9; margin-bottom: 0.5em;">Tasa de ConversiÃ³n</div>
        <div style="font-size: 1.75rem; font-weight: 700;">{{ formatPercentage(livestreamData.stats.closureRate) }}</div>
      </div>
    </div>
  </div>
</div>

<!-- Barra de Progreso: Monto Vendido vs Estimado -->
<div class="card" *ngIf="livestreamData">
  <div class="card-body">
    <h2 class="card-title">Progreso de Ventas</h2>
    
    <div style="margin-top: 1em;">
      <div style="display: flex; justify-content: space-between; margin-bottom: 0.5em;">
        <span style="color: #1D2345; font-weight: 600;">
          {{ formatCurrency(livestreamData.stats.totalClosedAmount) }} de {{ formatCurrency(livestreamData.stats.totalEstimatedAmount) }} vendido
        </span>
        <span style="color: #667eea; font-weight: 700;">
          {{ formatPercentage((livestreamData.stats.totalClosedAmount / livestreamData.stats.totalEstimatedAmount) * 100) }}
        </span>
      </div>
      
      <div style="width: 100%; background-color: #e9ecef; border-radius: 10px; height: 30px; overflow: hidden;">
        <div [style.width.%]="(livestreamData.stats.totalClosedAmount / livestreamData.stats.totalEstimatedAmount) * 100"
             style="height: 100%; background: linear-gradient(90deg, #667eea 0%, #764ba2 100%); transition: width 0.3s ease;">
        </div>
      </div>
      
      <div style="margin-top: 0.5em; color: #6C757D; font-size: 0.875rem;">
        Inventario restante: {{ formatCurrency(livestreamData.stats.totalEstimatedAmount - livestreamData.stats.totalClosedAmount) }}
      </div>
    </div>
  </div>
</div>


